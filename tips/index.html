<!DOCTYPE html>
<html lang="pr-br">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> AppsecTips | caon.io</title>
  <link rel = 'canonical' href = 'https://caon.io/tips/'>
  <meta name="description" content="Reach me out `felipecaon[at]gmail[dot]com`">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  
  
    
  
  
  <link rel="stylesheet" href="https://caon.io/css/styles.09272875ae42fc246de6521b52196952ad5a1e1684cf7e5afbedcd2600a922019d2fd15d26f1757f660da81db00b900eb3802dbb7ef450d1fd5d06767b04fd2c.css" integrity="sha512-CScoda5C/CRt5lIbUhlpUq1aHhaEz35a&#43;&#43;3NJgCpIgGdL9FdJvF1f2YNqB2wC5AOs4Atu370UNH9XQZ2ewT9LA=="> 

  
   <link rel="stylesheet" href="https://caon.io/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://caon.io/">
  
  
  <div id="title">
    <h1>caon.io</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/posts">Writings</a></li>
      
        <li><a href="/tips">AppSec Tips</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <p>This is a forever ongoing post, containing appsec tips to know when testing applications.
Most of tips were found in books, twitter or medium posts.</p>
<h2 id="encodings">Encodings</h2>
<p>Sometimes it is necessary to decode an authentication string or HTML encode information, for all purposes, use CyberChef:</p>
<p><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></p>
<p><strong>Pro Tip:</strong> The <code>magic</code> formula is truly magic.</p>
<h2 id="open-redirect">Open Redirect</h2>
<p>Often a bug that brings impact when chained.</p>
<h3 id="open-redirect-in-helpdesk">Open redirect in helpdesk</h3>
<p>Sometimes a website will redirect only to a helpdesk subdomain, this behavior is interesting because it is possible to create a custom subdomain a place a <code>script</code> that will redirect to an evil website. Making it a open redirect.</p>
<h2 id="csrf">CSRF</h2>
<p>CRSF can be found when:</p>
<ul>
<li>There&rsquo;s no CSRF protection</li>
<li><code>GET</code> requests make calls that change data</li>
<li><code>POST</code> requests with no <code>OPTIONS</code> (preflight) call. Bad implementation.</li>
<li>CORS is badly configured</li>
</ul>
<p>Common bypasses:</p>
<ul>
<li>Change desired <code>POST</code> request to <code>GET</code>.</li>
<li>Change <code>POST</code> <code>Content-Type</code> header to:
<ul>
<li><code>application/x-www-form-urlencoded</code></li>
<li><code>multipart/form-data</code></li>
<li><code>text/plain</code></li>
</ul>
</li>
</ul>
<h2 id="http-parameter-pollution">HTTP parameter pollution</h2>
<p>When searching for HPP keep in mind some servers handle parameters differently.</p>
<p>Take <code>http://example.com?username=foo&amp;username=bar</code> as an example. PHP and Apache use the last <code>username</code> occurence. Tomcat uses the first occurence. ASP and IIS user all occurences.</p>
<p>A study containing all the servers can be found here: <a href="https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf">https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf</a></p>
<h2 id="xss">XSS</h2>
<p><a href="http://html5sec.org/">http://html5sec.org/</a> is a good place to find vectors, maintained by Cure53</p>
<h2 id="ssrf">SSRF</h2>
<p>Sometimes sites offer the possibility to make external requests using their server, what if we could user their &ldquo;external&rdquo; service to make requests for internal resources. That&rsquo;s SSRF.</p>
<p>If the site is hosted in amazon, it is possible to get internal information by requesting the urls:</p>
<pre><code>http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/iam/securty-credentials
</code></pre><p>Another idea is to try and request IP&rsquo;s that we know that are internal:</p>
<pre><code>10.0.0.0 to 10.255.255.55
100.64.0.0 to 10.127.255.255
127.0.0.0 to 127.255.255.255
127.16.0.0 to 127.31.255.255
192.0.0.0 to 192.0.0.255
198.18.0.0 to 198.19.255.255
</code></pre><p>Sometimes websites block external acess to localhost (ie 127.0.0.1). Fortunately it is possible to bypass restrictions by referencing localhost in other ways.</p>
<p>Did you know that <code>127.0.0.1</code> and <code>127.1</code> are the same thing?</p>
<p><a href="https://www.pyson.org/tools/ip_address_converter.php?ip=127.0.0.1">https://www.pyson.org/tools/ip_address_converter.php?ip=127.0.0.1</a> helps to discover alternative ways to reference localhost.</p>

  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  caon.io 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tips">AppSec Tips</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
